<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Spaza Track</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="styles.css" />
  <meta name="theme-color" content="#0a7" />
</head>
<body>
  <div id="auth" class="screen">
    <h1>Spaza Track</h1>
    <div class="card">
      <div class="tabs auth-tabs">
        <button class="tab-btn active" data-auth-tab="login">Login</button>
        <button class="tab-btn" data-auth-tab="register">Register</button>
      </div>
      <div data-auth-panel="login">
        <form id="login-form" class="stack">
          <label>Username<input id="login-username" autocomplete="username" required /></label>
          <label>Password<input id="login-password" type="password" autocomplete="current-password" required /></label>
          <button class="primary" type="submit">Login</button>
        </form>
      </div>
      <div data-auth-panel="register" class="hidden">
        <form id="register-form" class="stack">
          <label>Username<input id="reg-username" autocomplete="username" required /></label>
          <label>Email<input id="reg-email" type="email" autocomplete="email" required /></label>
          <label>Full Name<input id="reg-fullname" autocomplete="name" /></label>
          <label>Password<input id="reg-password" type="password" autocomplete="new-password" required /></label>
          <label>Role
            <select id="register-role">
              <option value="admin">Admin (creates shop)</option>
              <option value="employee">Employee (joins shop)</option>
            </select>
          </label>
          <div id="shop-name-row">
            <label>Shop Name<input id="reg-shop-name" placeholder="e.g., Main Street" /></label>
          </div>
          <div id="shop-id-row" class="hidden">
            <label>Shop ID or Name<input id="reg-shop-id" placeholder="Provided by admin" /></label>
          </div>
          <button class="primary" type="submit">Create Account</button>
        </form>
      </div>
      <p id="auth-error" class="error" aria-live="polite"></p>
    </div>
  </div>

  <div id="app" class="hidden">
    <header>
      <h1>Spaza Track</h1>
      <nav>
        <button class="tab-btn" data-tab="products">Products</button>
        <button class="tab-btn" data-tab="sales">Sales</button>
        <button class="tab-btn" data-tab="summary">Summary</button>
      </nav>
    </header>

    <main>
      <section id="tab-products" class="tab">
        <h2>Products</h2>
        <form id="add-product-form" class="card">
          <label>Name<input id="p-name" required /></label>
          <label>Cost Price (R)<input id="p-cost" type="number" step="0.01" min="0" required /></label>
          <label>Selling Price (R)<input id="p-sell" type="number" step="0.01" min="0" required /></label>
          <label>Quantity<input id="p-qty" type="number" min="0" step="1" max="9999" required /></label>
          <button class="primary" type="submit">Add Product</button>
        </form>

        <div class="card">
          <h3>Stock</h3>
          <div class="filter-row">
            <input id="product-filter" type="search" placeholder="Search products..." aria-label="Search products" />
          </div>
          <table class="list" aria-label="Product list">
            <thead>
              <tr>
                <th>Name</th>
                <th>Cost</th>
                <th>Sell</th>
                <th>Qty</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="products-tbody"></tbody>
          </table>
        </div>
      </section>

      <section id="tab-sales" class="tab hidden">
        <h2>Record Sale</h2>
        <form id="sale-form" class="card">
          <div class="filter-row">
            <input id="sale-filter" type="search" placeholder="Search products to sell..." aria-label="Search products to sell" />
          </div>
          <label>Product<select id="sale-product" required></select></label>
          <label>Quantity<input id="sale-qty" type="number" min="1" step="1" max="9999" required /></label>
          <button class="primary" type="submit">Sell</button>
        </form>

        <div class="card">
          <h3>Today’s Sales</h3>
          <table class="list" aria-label="Sales list">
            <thead>
              <tr>
                <th>Seller</th>
                <th>Item</th>
                <th>Qty</th>
                <th>Total (R)</th>
                <th id="profit-header">Profit (R)</th>
              </tr>
            </thead>
            <tbody id="sales-tbody"></tbody>
          </table>
        </div>
      </section>

      <section id="tab-summary" class="tab hidden">
        <h2>Daily Summary</h2>
        <div class="card">
          <p id="today-profit" class="profit">Today’s Profit: R0.00</p>
          <p id="stock-alerts" class="alert"></p>
          <button id="refresh-summary" class="secondary">Refresh</button>
        </div>
      </section>
    </main>

    <footer>
      <button id="lock-btn" class="secondary">Lock</button>
    </footer>
  </div>

  <script type="module" src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        const swUrl = new URL('sw.js', window.location.href);
        navigator.serviceWorker.register(swUrl.href).catch(console.error);
      });
    }
  </script>
</body>
</html>
